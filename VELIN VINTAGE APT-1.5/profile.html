<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Profile - VELIN VINTAGE</title>
    <link rel="icon" href="./assets/images/products/LOGO.png">
    <link rel="stylesheet" href="./css/profile.css">
</head>

<body>
    <header id="header">
        <div class="top-banner">
            FREE SHIPPING ON ORDERS OVER $200 | NEW ARRIVALS DAILY
        </div>
        <nav>
            <div class="logo" onclick="window.location.href='main.html'">VELIN VINTAGE</div>
            <ul class="nav-links">
                <li><a href="main.html#new">NEW IN</a></li>
                <li><a href="main.html#brands">BRANDS</a></li>
                <li><a href="LookBook.html">LOOK BOOK</a></li>
                <li><a href="main.html#market">MARKET</a></li>
                <li><a href="main.html#about">ABOUT</a></li>
            </ul>
            <div class="nav-icons">
                <span onclick="typeof toggleSearch === 'function' ? toggleSearch() : null">SEARCH</span>
                <span id="profileBtn" class="profile-btn" style="display:none;"
                    onclick="window.location.href='profile.html'">PROFILE</span>
                <span onclick="window.location.href='cart.html'">
                    CART
                    <span class="cart-badge" id="cartCount">0</span>
                </span>
                <span id="logoutBtn" class="logout-btn" style="display:none;">LOGOUT</span>
            </div>
        </nav>
    </header>

    <div class="profile-container">
        <div class="profile-header">
            <div class="profile-avatar" id="avatarLetter">U</div>
            <div class="profile-info">
                <div class="profile-name" id="profileName"></div>
                <div class="profile-email" id="profileEmail"></div>
                <div class="profile-joined" id="profileJoined"></div>
            </div>
            <button class="edit-profile-btn" onclick="openEditModal()">EDIT PROFILE</button>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value" id="collectionCount">0</div>
                <div class="stat-label">ITEMS IN COLLECTION</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="wishlistCount">0</div>
                <div class="stat-label">WISHLIST ITEMS</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalValue">$0</div>
                <div class="stat-label">COLLECTION VALUE</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalGain">+$0</div>
                <div class="stat-label">TOTAL GAIN</div>
            </div>
        </div>

        <div class="profile-tabs">
            <button class="tab-btn active" onclick="showTab('collection')">MY COLLECTION</button>
            <button class="tab-btn" onclick="showTab('wishlist')">WISHLIST</button>
            <button class="tab-btn" onclick="showTab('orders')">ORDER HISTORY</button>
        </div>

        <div id="collectionTab" class="tab-content active">
            <div class="products-grid" id="collectionGrid"></div>
        </div>

        <div id="wishlistTab" class="tab-content">
            <div class="products-grid" id="wishlistGrid"></div>
        </div>

        <div id="ordersTab" class="tab-content">
            <div class="empty-state">
                <div class="empty-state-icon">üì¶</div>
                <div class="empty-state-title">No Orders Yet</div>
                <div class="empty-state-text">Your order history will appear here</div>
                <a href="main.html#new" class="btn-browse">START SHOPPING</a>
            </div>
        </div>
    </div>

    <!-- Edit Profile Modal -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Edit Profile</div>
                <button class="modal-close" onclick="closeEditModal()">√ó</button>
            </div>
            <form id="editForm" onsubmit="saveProfile(event)">
                <div class="form-group">
                    <label class="form-label">FIRST NAME</label>
                    <input type="text" id="editFirstName" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">LAST NAME</label>
                    <input type="text" id="editLastName" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">EMAIL</label>
                    <input type="email" id="editEmail" class="form-input" disabled>
                </div>
                <div class="form-group">
                    <label class="form-label">PHONE NUMBER</label>
                    <input type="tel" id="editPhone" class="form-input">
                </div>
                <div class="form-group">
                    <label class="form-label">USERNAME</label>
                    <input type="text" id="editUsername" class="form-input">
                </div>
                <button type="submit" class="btn-save">SAVE CHANGES</button>
            </form>
        </div>
    </div>
    <!-- SEARCH PANEL & OVERLAY -->
    <div id="searchOverlay" class="search-overlay"></div>
    <div id="searchPanel" class="search-panel" aria-hidden="true">
        <button class="close-btn" aria-label="Close search">‚úï</button>
        <h2>Search</h2>
        <input id="searchInput" type="search" placeholder="ÏÉÅÌíàÎ™Ö, Î∏åÎûúÎìú, Ïπ¥ÌÖåÍ≥†Î¶¨Î°ú Í≤ÄÏÉâÌïòÏÑ∏Ïöî" aria-label="Search">
        <div id="searchResults" class="search-results"></div>
    </div>
</body>
        <script>
        function execDaumPostcode() {
            new daum.Postcode({
                oncomplete: function (data) {
                    document.getElementById('editPostcode').value = data.zonecode;
                    document.getElementById('editAddress').value = data.address;
                    document.getElementById('editAddressDetail').focus();
                }
            }).open();
        }

        document.addEventListener('DOMContentLoaded', function () {
            const cardInput = document.getElementById('editCardNumber');
            cardInput.addEventListener('input', function (e) {
                let v = e.target.value.replace(/\s/g, '').replace(/[^0-9]/gi, '');
                let parts = [];
                for (let i = 0; i < v.length; i += 4) {
                    parts.push(v.substring(i, i + 4));
                }
                e.target.value = parts.join(' ');
            });
        });

        function addCard() {
            const input = document.getElementById('editCardNumber');
            let num = input.value.replace(/\s/g, '');
            if (num.length !== 16) {
                showNotification('Ïπ¥ÎìúÎ≤àÌò∏ 16ÏûêÎ¶¨Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî');
                return;
            }
            if (!window.VELIN.currentUser.cards) window.VELIN.currentUser.cards = [];
            if (window.VELIN.currentUser.cards.includes(num)) {
                showNotification('Ïù¥ÎØ∏ Îì±Î°ùÎêú Ïπ¥ÎìúÏûÖÎãàÎã§');
                return;
            }
            window.VELIN.currentUser.cards.push(num);
            updateUserData();
            renderSavedCards();
            input.value = '';
            showNotification('Ïπ¥ÎìúÍ∞Ä Îì±Î°ùÎêòÏóàÏäµÎãàÎã§');
        }

        function renderSavedCards() {
            const list = document.getElementById('savedCardsList');
            const cards = window.VELIN.currentUser.cards || [];
            if (cards.length === 0) {
                list.innerHTML = '<div style="color:#666; padding:15px 0; font-size:14px;">Îì±Î°ùÎêú Ïπ¥ÎìúÍ∞Ä ÏóÜÏäµÎãàÎã§</div>';
                return;
            }
            list.innerHTML = cards.map((card, i) => {
                const last4 = card.slice(-4);
                const brand = /^4/.test(card) ? 'VISA' : /^5[1-5]/.test(card) ? 'MasterCard' : 'Card';
                return `
                    <div style="display:flex; justify-content:space-between; align-items:center; padding:15px; background:#0a0a0a; border:1px solid #333; border-radius:8px; margin-bottom:10px;">
                        <div>
                            <strong>${brand}</strong> ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ${last4}
                            <div style="font-size:12px; color:#888; margin-top:4px;">‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ${last4}</div>
                        </div>
                        <button type="button" onclick="removeCard(${i})" style="background:none; border:none; color:#f87171; font-size:24px; cursor:pointer;">√ó</button>
                    </div>`;
            }).join('');
        }

        function removeCard(i) {
            window.VELIN.currentUser.cards.splice(i, 1);
            updateUserData();
            renderSavedCards();
            showNotification('Ïπ¥ÎìúÍ∞Ä ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§');
        }

        function openEditModal() {
            const u = window.VELIN.currentUser;
            document.getElementById('editFirstName').value = u.firstName || '';
            document.getElementById('editLastName').value = u.lastName || '';
            document.getElementById('editEmail').value = u.email || '';
            document.getElementById('editPhone').value = u.phone || '';
            document.getElementById('editUsername').value = u.username || '';
            if (u.address) {
                document.getElementById('editPostcode').value = u.address.postcode || '';
                document.getElementById('editAddress').value = u.address.address || '';
                document.getElementById('editAddressDetail').value = u.address.detail || '';
            }
            renderSavedCards();
            document.getElementById('editModal').classList.add('active');
        }

        function saveProfile(e) {
            e.preventDefault();
            const u = window.VELIN.currentUser;
            u.firstName = document.getElementById('editFirstName').value.trim();
            u.lastName = document.getElementById('editLastName').value.trim();
            u.phone = document.getElementById('editPhone').value.trim();
            u.username = document.getElementById('editUsername').value.trim();
            u.address = {
                postcode: document.getElementById('editPostcode').value,
                address: document.getElementById('editAddress').value,
                detail: document.getElementById('editAddressDetail').value
            };
            updateUserData();
            loadProfile();
            closeEditModal();
            showNotification('ÌîÑÎ°úÌïÑÏù¥ Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§!');
        }
    </script>
<script src="./script.js/profile.js"></script>


</html>
